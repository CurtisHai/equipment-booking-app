{% extends 'bookings/base.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Need Help?</h2>

    <!-- Card for styling the content, similar to booking form design -->
    <div class="card p-4 w-75 mx-auto mb-5" style="color: #192d38;">
        
        <!-- Check if the user is authenticated -->
        {% if user.is_authenticated %}
            
            <!-- Check if the user has a valid email associated with their account -->
            {% if user.email %}
                <p>Our support team is here for you. Use the form below to contact us, and we&rsquo;ll reply via email.</p>

                <p>We can assist with:</p>
                <ul>
                    <li><strong>Technical Issues</strong> &ndash; Report problems for prompt resolution.</li>
                    <li><strong>General Questions</strong> &ndash; Ask about the booking system or policies.</li>
                    <li><strong>Booking Deletion</strong> &ndash; Can&rsquo;t delete a booking? We&rsquo;ll help.</li>
                    <li><strong>Special Requests</strong> &ndash; Submit equipment or accessibility needs.</li>
                    <li><strong>Backdating Bookings</strong> &ndash; Forgot to log usage? Contact us to update.</li>
                    <li><strong>Other Queries</strong> &ndash; Feedback or suggestions are always welcome.</li>
                </ul>

                <!-- Display form errors if there are any -->
                {% if form.errors %}
                <div class="alert alert-danger">
                    <p>Please correct the following errors:</p>
                    <ul>
                        {% for field, errors in form.errors.items %}
                            <li>{{ field }}: {{ errors }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}

                <!-- Contact form for users with a valid email -->
                <form method="post" action="{% url 'contact' %}">
                    {% csrf_token %}
                    
                    <!-- Bootstrap grid for form alignment -->
                    <div class="form-group row mb-3 justify-content-center">
                        <label for="subject" class="col-2 text-right">Subject:</label>
                        <div class="col-8">
                            {{ form.subject }}
                        </div>
                    </div>

                    <div class="form-group row mb-3 justify-content-center">
                        <label for="content" class="col-2 text-right">Message:</label>
                        <div class="col-8">
                            {{ form.content }}
                        </div>
                    </div>

                    <!-- Submit button centered -->
                    <div class="d-flex justify-content-center">
                        <button type="submit" class="btn btn-primary mt-4">Send Message</button>
                    </div>
                </form>
            
            <!-- If the user doesn't have an email -->
            {% else %}
                <p class="text-danger">You need to have an email associated with your account to send a message.</p>
                <a href="{% url 'accounts' %}" class="btn btn-secondary">Add your email here</a>
            {% endif %}

        <!-- For unauthenticated users -->
        {% else %}
            <p>If you would like to inquire about the booking app or need assistance creating an account, please contact <a href="mailto:support@atkinsrealisbookings.com">support@atkinsrealisbookings.com</a>.</p>
            <p>Alternatively, if you have an account, please <a href="{% url 'login' %}">Login</a> to access the support features.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
